:root {
  --ink: #f8f3e8;
  --bg-a: #0d1627;
  --bg-b: #251d27;
  --panel: #151f31dc;
  --panel-alt: #1e2434ef;
  --line: #ffffff2a;
  --accent: #ef6d45;
  --accent-2: #ffd06b;
  --good: #79db95;
  --bad: #ff6f77;
  --muted: #cad0df;
  --depth-shadow: 0 18px 36px #00000057;
  --mat-metal-hi: #c0d2ee;
  --mat-metal-mid: #20344f;
  --mat-metal-low: #0b121d;
  --mat-glass: #d2e6ff55;
  --mat-rubber: #1c1f29;
  --mat-ember: #ff8f52;
  --mat-smoke: #8f97a3;
  --mat-grass: #4a8742;
  --mat-asphalt: #4a515f;
  --mat-water: #2a75b5;
  font-family: "Space Grotesk", "Avenir Next", "Segoe UI", sans-serif;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  color: var(--ink);
  background:
    radial-gradient(circle at 12% 0%, #32578855, transparent 42%),
    radial-gradient(circle at 88% 10%, #7b3b3850, transparent 45%),
    linear-gradient(130deg, var(--bg-a), var(--bg-b));
  min-height: 100vh;
}

button,
input,
select,
textarea {
  font: inherit;
}

button {
  cursor: pointer;
  border: none;
  color: #fff;
  font-weight: 600;
  background: linear-gradient(90deg, var(--accent), #d9502d);
  border-radius: 10px;
  padding: 0.55rem 0.75rem;
}

button.secondary {
  background: #2a3f5f;
}

button.danger {
  background: #8a3030;
}

button:disabled {
  opacity: 0.55;
  cursor: not-allowed;
}

input,
select,
textarea {
  color: var(--ink);
  background: #0f1623;
  border-radius: 10px;
  border: 1px solid var(--line);
  width: 100%;
  margin-top: 0.24rem;
  margin-bottom: 0.7rem;
  padding: 0.58rem;
}

h1,
h2,
h3,
h4,
p,
ol,
ul {
  margin-top: 0;
}

.landing-shell {
  min-height: 100vh;
  padding: 1.2rem;
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
}

.landing-hero,
.landing-card {
  border: 1px solid var(--line);
  border-radius: 18px;
  padding: 1rem;
  background: linear-gradient(160deg, var(--panel), var(--panel-alt));
  box-shadow: 0 24px 45px #00000052;
}

.landing-hero {
  grid-column: 1 / -1;
}

.eyebrow {
  margin: 0 0 0.3rem;
  text-transform: uppercase;
  letter-spacing: 0.16em;
  color: var(--accent-2);
  font-size: 0.74rem;
}

.mode-selector {
  display: flex;
  gap: 0.6rem;
}

.mode-selector button {
  width: 100%;
}

.active {
  outline: 2px solid var(--accent-2);
}

.game-shell {
  min-height: 100vh;
  padding: 1rem;
  display: grid;
  gap: 1rem;
}

.game-topbar {
  border: 1px solid var(--line);
  border-radius: 18px;
  padding: 1rem;
  background: linear-gradient(165deg, #142031f2, #2a1d2af0);
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1rem;
  box-shadow: var(--depth-shadow);
}

.topbar-controls {
  display: grid;
  align-content: start;
  gap: 0.42rem;
}

.topbar-chipline {
  display: flex;
  gap: 0.4rem;
  flex-wrap: wrap;
}

.mini {
  width: auto;
}

.mini-switch {
  display: inline-flex;
  align-items: center;
  gap: 0.45rem;
  width: fit-content;
  padding: 0.2rem 0.45rem;
  border-radius: 12px;
  border: 1px solid var(--line);
  background: #101b2a;
}

.mini-switch input {
  width: auto;
  margin: 0;
  padding: 0;
}

.volume-inline {
  display: grid;
  gap: 0.2rem;
  width: 180px;
  font-size: 0.86rem;
}

.volume-inline input {
  margin: 0;
  padding: 0;
}

.audio-control {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.start-controls {
  border: 1px solid var(--line);
  border-radius: 12px;
  padding: 0.55rem;
  background: #0f1624;
}

.warning-text {
  color: var(--accent-2);
}

.panel-dashboard {
  display: grid;
  gap: 0.9rem;
  grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
}

.panel-slot {
  min-width: 0;
}

.scene-panel {
  border-radius: 16px;
  border: 1px solid var(--line);
  background: linear-gradient(165deg, #182239f2, #1a1f2ff3);
  box-shadow: var(--depth-shadow);
  padding: 0.85rem;
}

.visual-heavy {
  overflow: hidden;
}

.panel-chip-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
}

.panel-chip-row h3 {
  margin-bottom: 0;
}

.chip-strip {
  display: flex;
  flex-wrap: wrap;
  gap: 0.35rem;
}

.chip {
  display: inline-flex;
  align-items: center;
  border: 1px solid #ffffff29;
  background: #0f1625;
  border-radius: 999px;
  padding: 0.18rem 0.55rem;
  font-size: 0.72rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.chip.warning {
  border-color: #ffb16a90;
  color: #ffd8a6;
}

.chip.good {
  border-color: #83e8a091;
  color: #9effbe;
}

.chip.danger {
  border-color: #ff8e9585;
  color: #ffc2c7;
}

.chip.supporting {
  opacity: 0.85;
}

.visual-stage {
  position: relative;
  border-radius: 14px;
  border: 1px solid #ffffff18;
  background: radial-gradient(circle at 50% 10%, #1a304f, #0d1524 62%);
  overflow: hidden;
}

.geometry-layer,
.interaction-layer,
.fx-layer,
.map-fx,
.town-map-svg {
  display: block;
  width: 100%;
}

.geometry-layer {
  height: auto;
}

.map-fx,
.town-map-svg {
  height: 100%;
}

.fx-layer,
.map-fx,
.interaction-layer {
  position: absolute;
  inset: 0;
}

.fx-layer,
.map-fx {
  pointer-events: none;
  z-index: 4;
}

.interaction-layer {
  pointer-events: all;
  z-index: 6;
}

.geometry-layer {
  position: relative;
  z-index: 5;
}

.town-map-svg {
  position: absolute;
  inset: 0;
  z-index: 5;
}

.mission-stage {
  max-width: 420px;
  min-height: 170px;
}

.hud-ring,
.hud-ring-progress {
  fill: none;
  stroke-width: 12;
}

.hud-ring {
  stroke: #ffffff29;
}

.hud-ring-progress {
  stroke: #ff8a61;
  transform: rotate(-90deg);
  transform-origin: 70px 84px;
}

.hud-value {
  fill: #ffd28f;
  font-size: 24px;
  font-family: "Space Mono", monospace;
}

.hud-summary {
  fill: #f6efe2;
  font-size: 12px;
}

.hud-slack {
  fill: #ffd3a6;
  font-size: 11px;
}

.hud-status-pill {
  fill: #0f1a2c;
  stroke: #ffffff26;
}

.hud-status-text {
  fill: #cad4e9;
  font-size: 12px;
  text-transform: uppercase;
}

.bomb-stage {
  min-height: 280px;
}

.bomb-shell-body {
  fill: #0f1624;
  stroke: #ffffff2f;
  stroke-width: 2;
}

.module-bound {
  fill: #111e31;
  stroke: #ffffff1f;
}

.bomb-wire {
  stroke-width: 8;
  stroke-linecap: round;
}

.bomb-wire.red {
  stroke: #ce4646;
}

.bomb-wire.blue {
  stroke: #4c8fe3;
}

.bomb-wire.yellow {
  stroke: #d6b24a;
}

.bomb-wire.white {
  stroke: #d6d6d6;
}

.bomb-wire.black {
  stroke: #4b4b4b;
}

.wire-g.cut {
  opacity: 0.24;
}

.state-light {
  opacity: 0.3;
}

.state-light.active {
  opacity: 1;
  filter: drop-shadow(0 0 8px #ffffff99);
}

.state-light.green {
  fill: #89e9ad;
}

.state-light.amber {
  fill: #ffcc72;
}

.state-light.red {
  fill: #ff737a;
}

.symbol-node {
  fill: #13233a;
  stroke: #ffffff38;
}

.symbol-ring .active .symbol-node {
  fill: #ff824f;
}

.symbol-node-text {
  fill: #f8f0e2;
  font-size: 11px;
  text-transform: uppercase;
}

.stabilize-core {
  fill: #182841;
  stroke: #ffffff24;
}

.stabilize-progress {
  fill: none;
  stroke: #ffd06b;
  stroke-width: 4;
  transform: rotate(-90deg);
  transform-origin: 615px 195px;
}

.hit-wire,
.hit-symbol,
.hit-stabilize {
  cursor: pointer;
  fill: transparent;
  stroke: transparent;
  stroke-width: 22;
}

.hit-symbol {
  stroke-width: 16;
}

.hit-stabilize {
  stroke-width: 26;
}

.hit-wire:hover,
.hit-symbol:hover,
.hit-stabilize:hover {
  stroke: #ffffff2f;
}

.hit-wire.disabled,
.hit-symbol.disabled,
.hit-stabilize.disabled {
  cursor: not-allowed;
  opacity: 0.45;
}

.sequence-pips {
  margin-top: 0.45rem;
  display: flex;
  gap: 0.3rem;
  flex-wrap: wrap;
}

.sequence-pip {
  width: 26px;
  height: 26px;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #ffffff29;
  background: #101d31;
  font-size: 0.72rem;
}

.rulebook-stage {
  min-height: 360px;
}

.manual-page {
  fill: #f6ead2;
  stroke: #3f3524;
}

.manual-title {
  fill: #3d2d1e;
  font-size: 20px;
  font-weight: 700;
}

.manual-diagram {
  fill: none;
  stroke-width: 4;
  stroke-linecap: round;
}

.manual-diagram.wire {
  stroke: #415f85;
}

.manual-diagram.glyph {
  stroke: #7a4d40;
}

.manual-diagram.safety {
  stroke: #6a6252;
}

.manual-pin circle,
.manual-pin line {
  stroke: #3d2c1a;
  fill: #e7c59f;
}

.manual-hotspot {
  fill: #ac7a4036;
  stroke: #795c33;
  stroke-dasharray: 4 5;
  cursor: pointer;
}

.rulebook-controls {
  margin-top: 0.45rem;
  display: flex;
  gap: 0.45rem;
}

.icon-btn {
  width: 46px;
  aspect-ratio: 1;
  border-radius: 999px;
}

.hotspot-detail {
  margin-top: 0.45rem;
  border: 1px solid var(--line);
  border-radius: 10px;
  padding: 0.45rem;
  background: #0f1628;
  display: grid;
  gap: 0.18rem;
}

.safety-stage {
  min-height: 180px;
}

.safety-ring-track,
.safety-ring-fill {
  fill: none;
  stroke-width: 12;
}

.safety-ring-track {
  stroke: #ffffff2b;
}

.safety-ring-fill {
  stroke: #ff8758;
  transform: rotate(-90deg);
  transform-origin: 160px 90px;
}

.safety-lever-base {
  fill: #112037;
  stroke: #ffffff27;
}

.safety-lever {
  fill: #cad1df;
}

.risk-label-large {
  fill: #ffd595;
  font-size: 18px;
  font-family: "Space Mono", monospace;
}

.alarm-dots {
  margin-top: 0.4rem;
  display: flex;
  gap: 0.35rem;
}

.alarm-dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: #ff915d;
  box-shadow: 0 0 12px #ff905f99;
}

.coordination-stage {
  padding: 0.5rem;
  display: grid;
  gap: 0.5rem;
}

.coord-lanes {
  display: grid;
  gap: 0.4rem;
}

.coord-card {
  border: 1px solid var(--line);
  border-radius: 10px;
  padding: 0.4rem 0.45rem;
  display: grid;
  grid-template-columns: 24px 10px 1fr;
  align-items: center;
  gap: 0.35rem;
  background: #101a2b;
}

.coord-card p {
  margin: 0;
  font-size: 0.84rem;
}

.coord-card.complete {
  border-color: #78d48f88;
  background: #10231e;
}

.coord-index {
  font-family: "Space Mono", monospace;
  color: #8fa6ce;
  font-size: 0.74rem;
}

.coord-dot {
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: #ffad79;
}

.coord-card.complete .coord-dot {
  background: #86eaab;
}

.confirmation-trail {
  display: flex;
  gap: 0.38rem;
  overflow-x: auto;
  padding-bottom: 0.15rem;
}

.trail-chip {
  min-width: 180px;
  border: 1px solid var(--line);
  border-radius: 10px;
  padding: 0.38rem;
  background: #0d1524;
  display: grid;
  gap: 0.1rem;
  font-size: 0.76rem;
}

.map-stage {
  min-height: 0;
}

.bushfire-map-panel .visual-stage {
  background:
    radial-gradient(circle at 18% 8%, #5a9b5e55, transparent 36%),
    radial-gradient(circle at 82% 0%, #6ea4c03f, transparent 42%),
    linear-gradient(165deg, #1b3b2f, #17352e 50%, #122631);
}

.map-zone {
  fill: url(#zoneFill);
  stroke: #ffffff40;
  stroke-width: 1.2;
  cursor: pointer;
}

.map-zone-shadow {
  fill: #03070fcc;
  opacity: 0.44;
  pointer-events: none;
}

.map-zone-rim {
  fill: none;
  stroke: url(#zoneRim);
  stroke-width: 1.2;
  opacity: 0.55;
  pointer-events: none;
}

.map-zone.focused {
  stroke: #ffd291;
  stroke-width: 2.2;
}

.zone-heat {
  pointer-events: none;
  mix-blend-mode: screen;
}

.zone-name {
  fill: #fff8de;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.03em;
  text-shadow: 0 1px 1px #05121e;
}

.zone-fire-track,
.zone-fire-ring {
  fill: none;
  stroke-width: 3.2;
  pointer-events: none;
}

.zone-fire-track {
  stroke: #ffffff20;
}

.zone-fire-ring {
  stroke: #ff9c68;
  filter: drop-shadow(0 0 5px #ff7f4996);
}

.zone-pop-pips {
  fill: #cde5c6;
  opacity: 0.85;
  pointer-events: none;
}

.zone-radial-actions {
  pointer-events: all;
}

.radial-tool {
  fill: #142538;
  stroke: #ffffff4b;
  cursor: pointer;
  filter: drop-shadow(0 2px 4px #00000066);
}

.radial-tool:hover {
  fill: #244369;
}

.radial-tool.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.radial-tool-label {
  fill: #ffe7c5;
  font-size: 9px;
  pointer-events: none;
}

.wind-glyph path {
  stroke: #f4d6a4;
  stroke-width: 3;
  fill: none;
  opacity: 0.82;
}

.asset-slot {
  fill: #0f2238;
  stroke: #8ec6ff7f;
  stroke-width: 1.8;
  cursor: grab;
  filter: drop-shadow(0 2px 3px #00000066);
}

.asset-slot.active {
  fill: #244c73;
  stroke: #ffd19c;
}

.asset-slot.disabled {
  opacity: 0.55;
  cursor: not-allowed;
}

.asset-slot-label {
  fill: #f4e8d2;
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.08em;
}

.asset-slot-icon {
  fill: none;
  stroke: #dceaf8;
  stroke-width: 1.6;
  stroke-linecap: round;
  stroke-linejoin: round;
  transform: translate(-9px, 0);
  pointer-events: none;
}

.drag-token {
  fill: #28517abf;
  stroke: #ffd59d;
  stroke-width: 1.8;
}

.zone-focus-hud {
  margin-top: 0.5rem;
  border: 1px solid #ffffff1f;
  border-radius: 12px;
  padding: 0.4rem 0.5rem 0.48rem;
  background: linear-gradient(130deg, #0f1c2eb8, #121f28b8);
  display: grid;
  gap: 0.32rem;
}

.zone-focus-name {
  font-size: 0.76rem;
  text-transform: uppercase;
  letter-spacing: 0.09em;
  color: #f7ebcd;
}

.zone-focus-meters {
  display: grid;
  gap: 0.24rem;
}

.zone-meter {
  height: 8px;
  border-radius: 999px;
  border: 1px solid #ffffff21;
  background: #0b1220;
  overflow: hidden;
}

.zone-meter span {
  display: block;
  height: 100%;
  border-radius: inherit;
}

.zone-meter.fire span {
  background: linear-gradient(90deg, #f7a25b, #e64f39);
}

.zone-meter.pop span {
  background: linear-gradient(90deg, #6fc9d8, #5f88d6);
}

.ops-stage,
.public-info-stage,
.command-stage {
  padding: 0.5rem;
}

.ops-pips {
  display: flex;
  gap: 0.36rem;
  margin-bottom: 0.55rem;
}

.ops-pip {
  width: 16px;
  height: 16px;
  border-radius: 999px;
  border: 1px solid var(--line);
}

.ops-pip.active {
  background: radial-gradient(circle at 30% 30%, #a8e6ff, #4782d5);
  box-shadow: 0 0 12px #8ab8f8a1;
}

.ops-pip.spent {
  background: #111b2c;
}

.zone-token-lane {
  display: flex;
  gap: 0.35rem;
  flex-wrap: wrap;
}

.zone-token {
  border-radius: 10px;
  border: 1px solid var(--line);
  padding: 0.28rem 0.48rem;
  font-size: 0.76rem;
  background: #0f1828;
  display: inline-flex;
  gap: 0.3rem;
}

.zone-token.hot {
  border-color: #ff976d8c;
}

.zone-token.evac {
  border-color: #83aaf398;
}

.zone-token.blocked {
  border-color: #ff6e7194;
}

.lane-stack {
  display: grid;
  gap: 0.55rem;
}

.lane-card {
  border: 1px solid var(--line);
  border-radius: 12px;
  padding: 0.45rem;
  background: #0f1626;
}

.lane-card h4 {
  margin-bottom: 0.35rem;
}

.broadcast-ring,
.broadcast-fill {
  fill: none;
  stroke-width: 10;
}

.broadcast-ring {
  stroke: #ffffff2b;
}

.broadcast-fill {
  stroke: #ff8758;
  transform: rotate(-90deg);
  transform-origin: 85px 90px;
}

.broadcast-label {
  fill: #ffddab;
  font-size: 22px;
  font-family: "Space Mono", monospace;
}

.cadence-label {
  fill: #9ab3db;
  font-size: 12px;
  text-transform: uppercase;
}

.cadence-hint {
  fill: #ecf0f7;
  font-size: 12px;
}

.ticker-frame {
  fill: #0f1a2c;
  stroke: #ffffff2c;
}

.ticker-line {
  fill: #d4def2;
  font-size: 10px;
}

.composer-lens {
  margin-top: 0.45rem;
  display: grid;
  gap: 0.42rem;
}

.template-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.3rem;
}

.template-chip {
  border-radius: 999px;
  padding: 0.26rem 0.56rem;
  font-size: 0.74rem;
  background: #243a5b;
}

.public-info-panel textarea {
  margin: 0;
  min-height: 54px;
  resize: vertical;
}

.beacon-button {
  width: 58px;
  aspect-ratio: 1;
  border-radius: 999px;
  justify-self: end;
  font-family: "Space Mono", monospace;
}

.radar-ring {
  fill: none;
  stroke: #ffffff24;
  stroke-width: 2;
}

.radar-sweep {
  stroke: #8acbff;
  stroke-width: 3;
}

.risk-card {
  fill: #101a2b;
  stroke: #ffffff1f;
}

.risk-card-text {
  fill: #d6e0f2;
  font-size: 11px;
}

.objective-lane {
  display: grid;
  gap: 0.4rem;
  margin-top: 0.5rem;
}

.objective-chip {
  border-radius: 10px;
  border: 1px solid var(--line);
  background: #0f1728;
  padding: 0.34rem 0.44rem;
  display: grid;
  grid-template-columns: 20px 1fr;
  gap: 0.4rem;
  font-size: 0.79rem;
}

.gm-stage {
  padding: 0.48rem;
}

.gm-stage-surface {
  fill: #0f1b2e;
  stroke: #ffffff23;
}

.camera-node {
  fill: #58b5ff6b;
  stroke: #9ad7ff;
}

.camera-label {
  fill: #c9dbf8;
  font-size: 11px;
}

.risk-node {
  fill: #ff795f5a;
  stroke: #ff997c;
}

.risk-hotspot-label {
  fill: #ffd3c5;
  font-size: 10px;
}

.drawer-tabs {
  margin-top: 0.45rem;
  display: flex;
  gap: 0.34rem;
  flex-wrap: wrap;
}

.drawer-tab {
  border-radius: 999px;
  background: #1a3152;
  padding: 0.26rem 0.58rem;
  font-size: 0.75rem;
}

.drawer-tab.active {
  background: linear-gradient(90deg, #ef6d45, #d9502d);
}

.drawer-stack {
  margin-top: 0.45rem;
}

.gm-drawer {
  border: 1px solid var(--line);
  border-radius: 12px;
  padding: 0.5rem;
  background: #0f1728;
}

.gm-player-pills,
.gm-role-picker,
.grant-grid,
.lock-grid,
.sim-role-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 0.32rem;
}

.gm-player-pill,
.role-pill,
.grant-chip,
.lock-chip,
.sim-role-chip {
  border-radius: 999px;
  background: #253d62;
  padding: 0.24rem 0.52rem;
  font-size: 0.74rem;
}

.gm-player-pill.active,
.role-pill.active,
.grant-chip.active,
.sim-role-chip.active {
  background: #3f6fa9;
}

.lock-chip.locked {
  background: #6e3030;
}

.timeline-strip {
  border: 1px solid var(--line);
  border-radius: 16px;
  padding: 0.8rem;
  background: #101a2a;
}

.timeline-chip-lane {
  display: flex;
  gap: 0.34rem;
  overflow-x: auto;
}

.timeline-chip {
  border: 1px solid var(--line);
  border-radius: 999px;
  padding: 0.24rem 0.56rem;
  background: #111d30;
  font-size: 0.76rem;
  white-space: nowrap;
}

.timeline-chip.inject {
  border-color: #ff9a7188;
}

.timeline-chip.system {
  border-color: #8db7ff87;
}

.error {
  color: var(--bad);
  font-weight: 700;
}

.layered-scene {
  position: relative;
  transform-style: preserve-3d;
  perspective: var(--scene-perspective, 820px);
}

.layered-scene.animated .geometry-layer,
.layered-scene.animated .fx-layer {
  animation: subtleFloat 4.8s ease-in-out infinite;
}

.cinematic-depth {
  border: 1px solid #ffffff23;
  box-shadow:
    0 30px 52px #02060f99,
    inset 0 1px 0 #ffffff24;
  background:
    radial-gradient(circle at 18% 0%, #334f7582, transparent 40%),
    radial-gradient(circle at 82% 100%, #582f2069, transparent 45%),
    linear-gradient(150deg, #0f1b2d, #121c2d 48%, #0c121d);
}

.depth-parallax-group {
  position: relative;
  z-index: 2;
}

.specular-overlay,
.shadow-caster,
.rim-light {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;
}

.specular-overlay {
  background:
    linear-gradient(var(--spec-angle), rgba(255, 255, 255, calc(var(--spec-intensity) * 0.22)), rgba(255, 255, 255, 0)),
    radial-gradient(circle at 18% 12%, rgba(198, 220, 255, calc(var(--spec-intensity) * 0.35)), transparent 40%);
  mix-blend-mode: screen;
}

.shadow-caster {
  background: radial-gradient(circle at 50% calc(66% + var(--shadow-offset-y)), rgba(0, 0, 0, var(--shadow-opacity)), transparent 66%);
  filter: blur(var(--shadow-blur));
}

.rim-light {
  box-shadow: inset 0 -18px 28px color-mix(in srgb, var(--rim-color) calc(var(--rim-intensity) * 100%), transparent);
}

.bomb-stage-root,
.manual-stage-root,
.map-stage-root {
  position: relative;
  min-height: inherit;
}

.map-stage-root {
  aspect-ratio: 720 / 420;
  min-height: 0;
}

.map-stage-root > .depth-parallax-group {
  position: absolute;
  inset: 0;
}

.map-stage-root::after {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 3;
  pointer-events: none;
  background: linear-gradient(112deg, transparent 30%, #b8ffe21f 50%, transparent 70%);
  animation: mapSweep 10s ease-in-out infinite;
}

.bomb-cinematic-pcb,
.bomb-cinematic-scratches,
.bomb-cinematic-reflection,
.map-backdrop,
.map-water-mask,
.manual-desk-backdrop {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.bomb-cinematic-pcb,
.bomb-cinematic-scratches {
  object-fit: cover;
  opacity: 0.34;
  mix-blend-mode: screen;
}

.bomb-cinematic-reflection {
  background:
    radial-gradient(circle at 16% 8%, #b4d8ff45, transparent 36%),
    linear-gradient(110deg, #ffffff20, #ffffff00 44%);
}

.manual-desk-backdrop {
  object-fit: cover;
  opacity: 0.24;
  mix-blend-mode: multiply;
}

.map-backdrop,
.map-water-mask {
  object-fit: cover;
  opacity: 0.2;
}

.map-water-mask {
  mix-blend-mode: screen;
  opacity: 0.56;
}

.energy-arc {
  fill: none;
  stroke: #84bfff;
  stroke-width: 2.4;
  stroke-dasharray: 8 10;
  opacity: 0.35;
}

.energy-arc.active {
  filter: drop-shadow(0 0 5px #8dccff);
}

.bomb-component rect {
  fill: #1f314b;
  stroke: #dce8ff33;
}

.bomb-component .component-label {
  fill: #e7f0ff;
  font-size: 8px;
  font-family: "Space Mono", monospace;
  letter-spacing: 0.04em;
}

.bomb-component.display rect {
  fill: #112d46;
  stroke: #6cc1ff88;
}

.bomb-component.fuse rect {
  fill: #3f3a2a;
  stroke: #f0cf7f7a;
}

.bomb-component.busbar rect {
  fill: url(#busbarGlow);
}

.bomb-component.fault rect {
  stroke: #ff8e7a;
  filter: drop-shadow(0 0 3px #ff6e6e7d);
}

.bomb-component.cut rect {
  opacity: 0.6;
}

.interaction-hit {
  fill: transparent;
  stroke: transparent;
}

.interaction-hit.enabled:hover {
  stroke: #ffffff46;
  fill: #ffffff18;
}

.interaction-hit.disabled {
  opacity: 0.45;
}

.manual-page-shadow {
  fill: #0000002f;
  filter: blur(5px);
}

.manual-diagram.background {
  opacity: 0.55;
}

.manual-diagram.mid {
  opacity: 0.84;
}

.manual-diagram.foreground {
  opacity: 1;
}

.manual-corner-curl {
  cursor: pointer;
  filter: drop-shadow(-2px -2px 4px #6d5a4788);
}

.manual-page-tab {
  fill: none;
  stroke: #98795a80;
  stroke-width: 10;
  cursor: pointer;
}

.manual-hotspot {
  transition: opacity 180ms ease;
}

.manual-hotspot:hover {
  opacity: 0.9;
}

.cinematic-tabs {
  justify-content: flex-end;
}

.terrain-patch-shadow {
  fill: #02060f;
  pointer-events: none;
}

.terrain-patch-fill {
  stroke: #ffffff21;
  stroke-width: 0.8;
}

.terrain-patch-rim {
  fill: none;
  stroke: #ffffff1a;
  stroke-width: 1;
  pointer-events: none;
}

.terrain-layer.grassland .terrain-patch-fill {
  fill: #5f9f55;
}

.terrain-layer.forest .terrain-patch-fill {
  fill: #3a7a3b;
}

.terrain-layer.urban .terrain-patch-fill {
  fill: #6f737b;
}

.terrain-layer.water .terrain-patch-fill {
  fill: #3175b5;
}

.terrain-layer.asphalt .terrain-patch-fill {
  fill: #495266;
}

.terrain-layers {
  animation: canopyDrift 9.4s ease-in-out infinite;
  transform-origin: center;
}

.terrain-road-shadow {
  fill: none;
  stroke: #04070f8c;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.terrain-road {
  fill: none;
  stroke: #525d6e;
  stroke-linecap: round;
  stroke-linejoin: round;
  opacity: 0.85;
}

.terrain-road-centerline {
  fill: none;
  stroke: #c9d3e2;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke-dasharray: 8 8;
  opacity: 0.5;
}

.terrain-river-bed {
  fill: none;
  stroke: #1a3f63;
  stroke-linecap: round;
  stroke-linejoin: round;
  opacity: 0.42;
}

.terrain-river {
  fill: none;
  stroke: #2f89cf;
  stroke-linecap: round;
  stroke-linejoin: round;
  opacity: 0.62;
}

.terrain-river-highlight {
  fill: none;
  stroke: #9fd8ff;
  stroke-linecap: round;
  stroke-linejoin: round;
  opacity: 0.62;
}

.terrain-tree-shadow {
  fill: #10231a;
  opacity: 0.45;
}

.terrain-tree-canopy {
  fill: #2e5f31;
  stroke: #486f3f;
  stroke-width: 0.6;
}

.terrain-landmark-shadow {
  fill: #04071066;
}

.terrain-landmark-disc {
  fill: #dce8f8;
  stroke: #283f5b;
  stroke-width: 1.2;
}

.terrain-landmark-glyph {
  fill: #20364f;
  stroke: #20364f;
  stroke-width: 1;
}

.terrain-landmark.hospital .terrain-landmark-disc {
  fill: #ffd6d6;
}

.terrain-landmark.station .terrain-landmark-disc {
  fill: #d6e0ff;
}

.wind-sample {
  stroke: #d9f5e8;
  stroke-width: 1.2;
  stroke-linecap: round;
}

.fire-front-contour {
  fill: none;
  stroke: #ff9c68;
  stroke-width: 2.2;
  stroke-linejoin: round;
  stroke-linecap: round;
  stroke-dasharray: 8 8;
  filter: drop-shadow(0 0 4px #ff8a4a);
}

.drop-feedback {
  fill: transparent;
  stroke-width: 3;
  pointer-events: none;
}

.drop-feedback.valid {
  stroke: #85e5ac;
}

.drop-feedback.invalid {
  stroke: #ff8f86;
}

.asset-slot {
  transition: transform 140ms ease, filter 140ms ease;
}

.asset-slot.active {
  transform: translateY(-3px);
  filter: drop-shadow(0 0 9px #ffd39f99);
}

.map-zone {
  transition: transform 180ms ease, stroke 180ms ease, filter 180ms ease;
}

.map-zone.focused {
  filter: drop-shadow(0 0 8px #ffd29172);
}

.zone-radial-actions .radial-tool {
  filter: drop-shadow(0 2px 4px #0000007f);
}

.zone-radial-actions .radial-tool:hover {
  transform: translateY(-1px);
}

@keyframes subtleFloat {
  0% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-1px);
  }

  100% {
    transform: translateY(0);
  }
}

@keyframes canopyDrift {
  0% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-1.2px);
  }

  100% {
    transform: translateY(0);
  }
}

@keyframes mapSweep {
  0% {
    transform: translateX(-26%);
    opacity: 0.05;
  }

  40% {
    opacity: 0.18;
  }

  100% {
    transform: translateX(30%);
    opacity: 0.05;
  }
}

@media (max-width: 920px) {
  .game-topbar {
    grid-template-columns: 1fr;
  }

  .panel-dashboard {
    grid-template-columns: 1fr;
  }

  .volume-inline {
    width: 100%;
  }
}
